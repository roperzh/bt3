BT={};var DataChannel=function(){var a,b="ws://ws.blockchain.info:8335/inv",c=function(){return a=new WebSocket(b),{ws:a,start:e}},d=function(b){var c=new CustomEvent("sentmessage");c.data=b,a.dispatchEvent(c)},e=function(){f({op:"unconfirmed_sub"})},f=function(b){b=JSON.stringify(b),d(b),a.send(b)};return c()},IpDecoder=function(){var a,b="http://freegeoip.net/json/",c=[],d={},e=function(){return a=setInterval(h,1e3),{queue:c}},f=function(){var a=JSON.parse(this.responseText);g(a),a.cached=!0,d[a.ip]=a},g=function(a){var b=new CustomEvent("geoip");b.data=a,document.dispatchEvent(b)},h=function(){var a,e;a=c.pop(),a&&"127.0.0.1"!==a&&(d[a]&&g(d[a]),e=new XMLHttpRequest,e.onload=f,e.open("get",b+a,!0),e.send())};return e()},LiveMap=function(){var a=L.map("map").setView([42.617791,-15.306702],3),b=L.icon({iconUrl:"images/marker-icon.png",iconSize:[10,10],iconAnchor:[5,5]}),c=function(){d(),e(),document.addEventListener("geoip",f)},d=function(){var b=($(window).height(),$(window).height());$("#map").css("height",b),a.invalidateSize()},e=function(){L.tileLayer("http://{s}.tile.cloudmade.com/2c83ee06868f422f8163dfae1d636cf0/118040/256/{z}/{x}/{y}.png",{maxZoom:3,minZoom:2}).addTo(a)},f=function(c){{var d=c.data;L.marker([d.latitude,d.longitude],{icon:b,bounceOnAdd:!0,bounceOnAddOptions:{duration:500,height:100},bounceOnAddCallback:function(){}}).addTo(a)}};return c()},LetterUpdater=function(){var a,b=$(window).width(),c=$(window).height(),d=["welcome to the awsomeness","explore about bitcoins","lalala"],e=function(){f(),g(d[0].split("")),setInterval(function(){g(d[Math.round(2*Math.random())].split(""))},1500)},f=function(){a=d3.select("#js-messageArea").append("svg").attr("width",b-70).attr("height",c-130).append("g").attr("transform","translate(32,"+c/2+")")},g=function(b){var c=[],d=[],e=a.selectAll("text").data(b,function(a){return this.dx?(d.push(a),a+d.count(a)):(c.push(a),a+c.count(a))});e.attr("class","update").transition().duration(750).attr("x",function(a,b){return 32*b}),e.enter().append("text").attr("class","enter").attr("dy",".35em").attr("y",-60).attr("x",function(a,b){return 32*b}).style("fill-opacity",1e-6).text(function(a){return a}).transition().duration(750).attr("y",0).style("fill-opacity",1),e.exit().transition().duration(750).attr("y",60).style("fill-opacity",1e-6).remove()};return e()},Calculator=function(a){var b=this;$("#js-calculator").find("input").on("keyup",function(){b.calc()});this.calc=function(){var b=$("#hashrate").val(),f=$("#usdbtc").val();$("#nmcblocktime").text(c(b,a)),$("#btcperday").text(d(b,a,1)),$("#btcperweek").text(d(b,a,7)),$("#btcpermonth").text(d(b,a,30)),$("#usdperday").text(e(b,a,f,1)),$("#usdperweek").text(e(b,a,f,7)),$("#usdpermonth").text(e(b,a,f,30))};var c=function(a,b){var c=4294967296*b/(1e6*a);return g(c)},d=function(a,b,c){var d=4294967296*b/(1e6*a),e=50/(d/(24*c)/60/60);return f(e,2)},e=function(a,b,c,e){var g=d(a,b,e),h=g*c;return f(h,2)},f=function(a,b){var c=Math.pow(10,b),d=Math.round(a*c)/c,e=d+"";return"."===e.substring(e.length-2,e.length-1)&&(d+="0"),d},g=function(a){a=Number(a);var b=Math.floor(a/3600/24),c=Math.floor(a/3600)-24*Math.floor(a/3600/24),d=Math.floor(a%3600/60),e=Math.floor(a%3600%60),f="";return b>0&&(f+=(b>1?b+" days":b+" day")+", "),c>0&&(f+=(c>1?c+" hours":c+" hour")+", "),d>0&&(f+=(d>1?d+" minutes":d+" minute")+", "),e>0&&(f+=(e>1?e+" seconds":e+" second")+", "),", "===f.substring(f.length-2)&&(f=f.substring(0,f.length-2)),f}},Test=function(){var a,b=$(window).width()-150,c=$(window).height(),d=Math.floor(b/70),e=["","","",""],f=function(){g(),setInterval(function(){var a=.4547*Number.random(30);h(Number.range(0,a).every(),e[0],a.toString().split(""))},1500)},g=function(){a=d3.select(".test").append("svg").attr("width",b-70).attr("height",c-130).append("g").attr("transform","translate(32,"+c/2+")")},h=function(b,c,e){var f=a.selectAll(".number").data(e,function(a){return a}).attr("y",-150);f.transition().duration(500).attr("x",function(a,b){return 32*b}),f.enter().append("text").attr("x",function(a,b){return 32*b}).attr("dy",".35em").attr("y",-60).attr("class","number").style("fill-opacity",1e-6).text(function(a){return a}).transition().duration(500).attr("y",0).style("fill-opacity",1),f.exit().transition().duration(500).attr("y",60).style("fill-opacity",1e-6).remove();var g=a.selectAll(".test").data(b,function(a){return a});g.attr("class","update test").transition().duration(750).attr("x",function(a,b){return 50*(b-d*Math.floor(b/d))}).attr("font-family","FontAwesome").text(function(){return c}),g.enter().append("text").attr("class","enter test").attr("dy",".35em").style("fill-opacity",1e-6).attr("x",0).transition().duration(750).text(function(){return c}).attr("y",function(a,b){return 60*Math.floor(b/d)}).style("fill-opacity",1),g.exit().transition().duration(750).attr("y",60).style("fill-opacity",1e-6).remove()};return f()};$(document).foundation(),blockChain=new DataChannel,geoIP=new IpDecoder,blockChain.ws.addEventListener("message",function(a){var b,c=JSON.parse(a.data);c.x&&c.x.relayed_by&&c.x.out&&(b=c.x.relayed_by,geoIP.queue.push(b))}),setTimeout(blockChain.start,3e3),$(".js-contentRegion").css({height:$(window).height()+"px"}),$(window).resize(function(){$(".js-contentRegion").css({height:$(window).height()+"px"})});var letterUpdater=new LetterUpdater,map=new LiveMap,calc=new Calculator(118092e4),test=new Test(223300861.7188927);